function varargout = render_results(u,res,img)
ind = find(~isnan(res.u_corr{:,'G_ij'}));
v = reshape(u(:,unique(res.u_corr{ind,'i'})),3,[]);

if nargout == 1
    assert(res.rd_div.q == 0, 'Distortion coefficient is non-zero!');
    varargout{1} = IMG.rectify(img.data,res.Hinf, ...
                               'Align','Yes', ...
                               'good_points', v, ...
                               'Fill', [255 255 255]');
elseif nargout == 2
    assert(res.rd_div.q ~= 0, 'Distortion coefficient is zero!');

    T0 = CAM.make_rd_div_tform(res.cc,res.rd_div.q);
    varargout{1} = IMG.rectify(img.data,res.Hinf, ...
                               'Transforms', { T0 }, ...
                               'Align', 'Yes', ...
                               'good_points', v, ...
                               'Fill', [255 255 255]');
    
    varargout{2} = IMG.ru_div(img.data,res.rd_div.cc,res.rd_div.q, ...
                              'Fill', [255 255 255]'); 
end
