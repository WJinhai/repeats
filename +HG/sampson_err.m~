function dx = sampson_err(u,H)
u = ut'
N = size(u,1);

e = [zeros(num_points,3) -u(1:3,:)'           [u([5 5 5],:).*u(1:3,:)]';...
     u(1:3,:)'            zeros(num_points,3) [-u([4 4 4],:).*u(1:3,:)]'];

j11 = -u(:,6)*H(2,1)+u(:,5)*H(3,1);
j12 = -u(:,6)*H(2,2)+u(:,5)*H(3,2);
j13 = -u(:,6)*H(2,3)+u(:,5)*H(3,3);

j14 = zeros(N,1);
j15 =  u(1:3)*[H(3,1) H(3,2) H(3,3)];
j16 =  -u(1:3)*[H(2,1) H(2,2) H(2,3)];

j21 = u(:,6)*H(1,1)-u(:,4)*H(3,1);
j22 = u(:,6)*H(1,2)-u(:,4)*H(3,2);
j23 = u(:,6)*H(1,3)-u(:,4)*H(3,3);

j24 =  -u(1:3)*[H(3,1) H(3,2) H(3,3)];
j25 = zeros(N,3);
j26 = u(1:3)*[H(1,1) H(1,2) H(1,3)];

J = [j11 j12 j13 j14 j15 j16; ...
     j21 j22 j23 j25 j25 j26];

dx = -J'*inv(J*J')*e;