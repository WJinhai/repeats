% Generated using GBSolver generator Copyright Martin Bujnak,
% Zuzana Kukelova, Tomas Pajdla CTU Prague 2008.
% 
% Please refer to the following paper, when using this code :
%     Kukelova Z., Bujnak M., Pajdla T., Automatic Generator of Minimal Problem Solvers,
%     ECCV 2008, Marseille, France, October 12-18, 2008

function [v1, v2, v3, l1, l2, k] = solver_H25lvk(x11, x1p1, x21, x2p1, x31, x3p1)

   		v1 = 10000;
		v2 = 10000;
		v3 = 10000;
		l1 = 10000;
		l2 = 10000;
		k = 10000;
        
	% precalculate polynomial equations coefficients
	c(1) = x11(1)*x1p1(2);
	c(2) = -x11(2)*x1p1(2);
	c(3) = x11(1)*x1p1(1);
	c(4) = -x11(2)*x1p1(1);
	c(5) = x11(1)*x1p1(1)^2 + x11(1)*x1p1(2)^2;
	c(6) = - x11(2)*x1p1(1)^2 - x11(2)*x1p1(2)^2;
	c(7) = x11(1);
	c(8) = -x11(2);
	c(9) = x11(1)*x1p1(2) - x11(2)*x1p1(1);
	c(10) = x21(1)*x2p1(2);
	c(11) = -x21(2)*x2p1(2);
	c(12) = x21(1)*x2p1(1);
	c(13) = -x21(2)*x2p1(1);
	c(14) = x21(1)*x2p1(1)^2 + x21(1)*x2p1(2)^2;
	c(15) = - x21(2)*x2p1(1)^2 - x21(2)*x2p1(2)^2;
	c(16) = x21(1);
	c(17) = -x21(2);
	c(18) = x21(1)*x2p1(2) - x21(2)*x2p1(1);
	c(19) = x11(1)^2*x1p1(2) + x11(2)^2*x1p1(2);
	c(20) = x11(1)^2*x1p1(1) + x11(2)^2*x1p1(1);
	c(21) = x11(1)^2*x1p1(1)^2 + x11(1)^2*x1p1(2)^2 + x11(2)^2*x1p1(1)^2 + x11(2)^2*x1p1(2)^2;
	c(22) = -x11(1)*x1p1(2);
	c(23) = -x11(1)*x1p1(1);
	c(24) = x1p1(2);
	c(25) = x1p1(1);
	c(26) = - x11(1)*x1p1(1)^2 - x11(1)*x1p1(2)^2;
	c(27) = x11(1)^2 + x11(2)^2 + x1p1(1)^2 + x1p1(2)^2;
	c(28) = -x11(1);
	c(29) = 1;
	c(30) = x11(1)^2*x1p1(1) - x11(1)*x1p1(1)^2 - x11(1)*x1p1(2)^2 + x11(2)^2*x1p1(1);
	c(31) = x1p1(1) - x11(1);
	c(32) = x21(1)^2*x2p1(2) + x21(2)^2*x2p1(2);
	c(33) = x21(1)^2*x2p1(1) + x21(2)^2*x2p1(1);
	c(34) = x21(1)^2*x2p1(1)^2 + x21(1)^2*x2p1(2)^2 + x21(2)^2*x2p1(1)^2 + x21(2)^2*x2p1(2)^2;
	c(35) = -x21(1)*x2p1(2);
	c(36) = -x21(1)*x2p1(1);
	c(37) = x2p1(2);
	c(38) = x2p1(1);
	c(39) = - x21(1)*x2p1(1)^2 - x21(1)*x2p1(2)^2;
	c(40) = x21(1)^2 + x21(2)^2 + x2p1(1)^2 + x2p1(2)^2;
	c(41) = -x21(1);
	c(42) = 1;
	c(43) = x21(1)^2*x2p1(1) - x21(1)*x2p1(1)^2 - x21(1)*x2p1(2)^2 + x21(2)^2*x2p1(1);
	c(44) = x2p1(1) - x21(1);
	c(45) = 1;
	c(46) = 1;
	c(47) = 1;
	c(48) = x31(1)*x3p1(2);
	c(49) = -x31(2)*x3p1(2);
	c(50) = x31(1)*x3p1(1);
	c(51) = -x31(2)*x3p1(1);
	c(52) = x31(1)*x3p1(1)^2 + x31(1)*x3p1(2)^2;
	c(53) = - x31(2)*x3p1(1)^2 - x31(2)*x3p1(2)^2;
	c(54) = x31(1);
	c(55) = -x31(2);
	c(56) = x31(1)*x3p1(2) - x31(2)*x3p1(1);

	M = zeros(80, 84);
	ci = [721, 1538, 1779, 1940, 2501, 2582, 2743, 3971, 4052, 4213, 4454, 4615, 5256, 5835];
	M(ci) = c(1);

	ci = [641, 1458, 1699, 1860, 2421, 2502, 2663, 3891, 3972, 4133, 4374, 4535, 5176, 5755];
	M(ci) = c(2);

	ci = [481, 1138, 1379, 1540, 2101, 2182, 2343, 3331, 3412, 3573, 3814, 4455, 5096, 5595];
	M(ci) = c(3);

	ci = [401, 1058, 1299, 1460, 2021, 2102, 2263, 3251, 3332, 3493, 3734, 4375, 5016, 5515];
	M(ci) = c(4);

	ci = [961, 2338, 2579, 2740, 2901, 2982, 3143, 4771, 4852, 5094, 5255, 5416, 6075];
	M(ci) = c(5);

	ci = [881, 2258, 2499, 2660, 2821, 2902, 3063, 4691, 4772, 4933, 5014, 5175, 5336, 5995];
	M(ci) = c(6);

	ci = [2961, 3538, 4019, 4180, 4741, 4822, 5574, 5815, 6056, 6315];
	M(ci) = c(7);

	ci = [2881, 3458, 3939, 4100, 4661, 4742, 4903, 5494, 5735, 5976, 6235];
	M(ci) = c(8);

	ci = [5361, 5618, 5779, 5860, 5941, 6022, 6103, 6211, 6292, 6373, 6454, 6535, 6616, 6715];
	M(ci) = c(9);

	ci = [642, 723, 1544, 1705, 1786, 1947, 2508, 2589, 2750, 3977, 4058, 4219, 4460, 4621, 5262, 5836];
	M(ci) = c(10);

	ci = [562, 643, 1464, 1625, 1706, 1867, 2428, 2509, 2670, 3897, 3978, 4139, 4380, 4541, 5182, 5756];
	M(ci) = c(11);

	ci = [402, 483, 1144, 1305, 1386, 1547, 2108, 2189, 2350, 3337, 3418, 3579, 3820, 4461, 5102, 5596];
	M(ci) = c(12);

	ci = [322, 403, 1064, 1225, 1306, 1467, 2028, 2109, 2270, 3257, 3338, 3499, 3740, 4381, 5022, 5516];
	M(ci) = c(13);

	ci = [882, 963, 2344, 2505, 2586, 2747, 2908, 2989, 3150, 4777, 4858, 5100, 5261, 5422, 6076];
	M(ci) = c(14);

	ci = [802, 883, 2264, 2425, 2506, 2667, 2828, 2909, 3070, 4697, 4778, 4939, 5020, 5181, 5342, 5996];
	M(ci) = c(15);

	ci = [2882, 2963, 3544, 3945, 4026, 4187, 4748, 4829, 5580, 5821, 6062, 6316];
	M(ci) = c(16);

	ci = [2802, 2883, 3464, 3865, 3946, 4107, 4668, 4749, 4910, 5500, 5741, 5982, 6236];
	M(ci) = c(17);

	ci = [5282, 5363, 5624, 5705, 5786, 5867, 5948, 6029, 6110, 6217, 6298, 6379, 6460, 6541, 6622, 6716];
	M(ci) = c(18);

	ci = [164, 245, 566, 647, 2431, 2512, 2673, 5197];
	M(ci) = c(19);

	ci = [4, 85, 326, 407, 2031, 2112, 2273, 5037];
	M(ci) = c(20);

	ci = [564, 645, 806, 887, 2831, 2912, 3073, 5357];
	M(ci) = c(21);

	ci = [1844, 1925, 2646, 2727, 4111, 4192, 4273, 5917];
	M(ci) = c(22);

	ci = [1444, 1525, 2246, 2327, 3471, 3552, 3633, 5677];
	M(ci) = c(23);

	ci = [1604, 1685, 2406, 2487, 3871, 3952, 4113, 5757];
	M(ci) = c(24);

	ci = [1204, 1285, 2006, 2087, 3231, 3312, 3473, 5517];
	M(ci) = c(25);

	ci = [2644, 2725, 3046, 3127, 4911, 6157];
	M(ci) = c(26);

	ci = [2404, 2485, 2806, 2887, 4671, 4752, 4913, 5997];
	M(ci) = c(27);

	ci = [4084, 4165, 4886, 6397];
	M(ci) = c(28);

	ci = [3844, 3925, 4646, 4727, 6237];
	M(ci) = c(29);

	ci = [5124, 5205, 5286, 5367, 5951, 6032, 6113, 6637];
	M(ci) = c(30);

	ci = [5684, 5765, 5926, 6007, 6191, 6272, 6353, 6717];
	M(ci) = c(31);

	ci = [168, 249, 570, 651, 2434, 2515, 2676, 5198];
	M(ci) = c(32);

	ci = [8, 89, 330, 411, 2034, 2115, 2276, 5038];
	M(ci) = c(33);

	ci = [568, 649, 810, 891, 2834, 2915, 3076, 5358];
	M(ci) = c(34);

	ci = [1848, 1929, 2650, 2731, 4114, 4195, 4276, 5918];
	M(ci) = c(35);

	ci = [1448, 1529, 2250, 2331, 3474, 3555, 3636, 5678];
	M(ci) = c(36);

	ci = [1608, 1689, 2410, 2491, 3874, 3955, 4116, 5758];
	M(ci) = c(37);

	ci = [1208, 1289, 2010, 2091, 3234, 3315, 3476, 5518];
	M(ci) = c(38);

	ci = [2648, 2729, 3050, 3131, 4914, 6158];
	M(ci) = c(39);

	ci = [2408, 2489, 2810, 2891, 4674, 4755, 4916, 5998];
	M(ci) = c(40);

	ci = [4088, 4169, 4890, 6398];
	M(ci) = c(41);

	ci = [3848, 3929, 4650, 4731, 6238];
	M(ci) = c(42);

	ci = [5128, 5209, 5290, 5371, 5954, 6035, 6116, 6638];
	M(ci) = c(43);

	ci = [5688, 5769, 5930, 6011, 6194, 6275, 6356, 6718];
	M(ci) = c(44);

	ci = [252, 653, 734, 1557, 1718, 1799, 1960, 2521, 2602, 2763, 3983, 4064, 4225, 4466, 4627, 5268, 5839];
	M(ci) = c(45);

	ci = [12, 333, 414, 1077, 1238, 1319, 1480, 2041, 2122, 2283, 3263, 3344, 3505, 3746, 4387, 5028, 5519];
	M(ci) = c(46);

	ci = [2652, 3053, 3134, 3637, 4118, 4199, 4280, 4921, 5666, 5907, 6148, 6399];
	M(ci) = c(47);

	ci = [255, 656, 737, 1564, 1725, 1806, 1967, 2528, 2609, 2770, 3989, 4070, 4231, 4472, 4633, 5274, 5840];
	M(ci) = c(48);

	ci = [175, 576, 657, 1484, 1645, 1726, 1887, 2448, 2529, 2690, 3909, 3990, 4151, 4392, 4553, 5194, 5760];
	M(ci) = c(49);

	ci = [95, 416, 497, 1164, 1325, 1406, 1567, 2128, 2209, 2370, 3349, 3430, 3591, 3832, 4473, 5114, 5600];
	M(ci) = c(50);

	ci = [15, 336, 417, 1084, 1245, 1326, 1487, 2048, 2129, 2290, 3269, 3350, 3511, 3752, 4393, 5034, 5520];
	M(ci) = c(51);

	ci = [655, 896, 977, 2364, 2525, 2606, 2767, 2928, 3009, 3170, 4789, 4870, 5112, 5273, 5434, 6080];
	M(ci) = c(52);

	ci = [575, 816, 897, 2284, 2445, 2526, 2687, 2848, 2929, 3090, 4709, 4790, 4951, 5032, 5193, 5354, 6000];
	M(ci) = c(53);

	ci = [2495, 2896, 2977, 3564, 3965, 4046, 4207, 4768, 4849, 5592, 5833, 6074, 6320];
	M(ci) = c(54);

	ci = [2415, 2816, 2897, 3484, 3885, 3966, 4127, 4688, 4769, 4930, 5512, 5753, 5994, 6240];
	M(ci) = c(55);

	ci = [5135, 5296, 5377, 5644, 5725, 5806, 5887, 5968, 6049, 6130, 6229, 6310, 6391, 6472, 6553, 6634, 6720];
	M(ci) = c(56);


	M = gj(M);

	A = zeros(4);
	amcols = [84 83 82 81];
	A(1, :) = -M(78, amcols);
	A(2, :) = -M(75, amcols);
	A(3, :) = -M(72, amcols);
	A(4, :) = -M(69, amcols);

	[V D] = eig(A);
	sol =  V([4, 3, 2],:)./(ones(3, 1)*V(1,:));

	if (find(isnan(sol(:))) > 0)
		
		v1 = zeros(1, 0);
		v2 = zeros(1, 0);
		v3 = zeros(1, 0);
		l1 = zeros(1, 0);
		l2 = zeros(1, 0);
		k = zeros(1, 0);
        
   		v1 = 10000;
		v2 = 10000;
		v3 = 10000;
		l1 = 10000;
		l2 = 10000;
		k = 10000;

	else
		
		%WARNING: cannot extract all unknowns at once. A back-substitution required (not implemented/automatized)
		ev  = diag(D);
		I = find(not(imag( sol(1,:) )) & not(imag( ev' )));
		v1 = ev(I)';
		l1 = sol(1,I);
		l2 = sol(2,I);
		k = sol(3,I);
        
        
        if isempty(I)
            v1 = 10000;
            l1 = 10000;
            l2 = 10000;
            k = 10000;
        end
    end
    for i = 1:size(v1,2)
       
         v2(i) = -(x1p1(2)*(x11(1) - l2(i)*v1(i)*x11(2)) - v1(i)*x11(2)*(k(i)*(x1p1(1)^2 + x1p1(2)^2) + 1) - x11(2)*x1p1(1)*(l1(i)*v1(i) + 1))/ (x11(1)*(k(i)*(x1p1(1)^2 + x1p1(2)^2) + 1) + l1(i)*x11(1)*x1p1(1) + l2(i)*x11(1)*x1p1(2));
         v3(i) = - v1(i)*l1(i) - v2(i)*l2(i);
    end
end
